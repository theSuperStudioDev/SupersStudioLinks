<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Cookie Clicker</title>
    <style>
        /* Cookie Clicker Styling */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f3f4f6;
            color: #333;
        }
        #game-container {
            text-align: center;
        }
        .cookie-btn {
            font-size: 24px;
            padding: 20px;
            border: none;
            background: #ff8c00;
            color: white;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .cookie-btn:hover {
            background: #ff6700;
        }
        .upgrade-btn {
            margin: 10px;
            padding: 10px;
            font-size: 16px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .upgrade-btn:hover {
            background: #45a049;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h1>Cookie Clicker</h1>
        <p>Cookies: <span id="cookie-count">0</span></p>
        <button class="cookie-btn" id="cookie-btn">üç™ Click Me</button>
        <div>
            <button class="upgrade-btn" id="upgrade-click-power">Upgrade Click Power</button>
            <button class="upgrade-btn" id="upgrade-cps">Upgrade CPS</button>
            <button class="upgrade-btn" id="max-upgrade">Max Upgrade</button>
        </div>
    </div>

    <script>
        // Dependencies: CryptoJS for encryption
        const cryptoJS = document.createElement('script');
        cryptoJS.src = "https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js";
        document.head.appendChild(cryptoJS);

        // IP Fetch API
        const IP_API = "https://api.ipify.org?format=json";
        const ENCRYPTION_KEY = "secure-encryption-key"; // Replace with a strong key

        // Game Variables
        let cookies = 0;
        let cps = 0;
        let cpc = 1;
        let clickPower = 0;
        let upgrades = [
            { name: "Click Power", cost: 50, multiplier: 2 },
            { name: "CPS", cost: 100, multiplier: 1 }
        ];

        // HTML Elements
        const cookieCountEl = document.getElementById("cookie-count");
        const cookieBtn = document.getElementById("cookie-btn");
        const upgradeClickPowerBtn = document.getElementById("upgrade-click-power");
        const upgradeCPSBtn = document.getElementById("upgrade-cps");
        const maxUpgradeBtn = document.getElementById("max-upgrade");

        // Fetch IP and register user
        async function fetchIPAndRegister() {
            try {
                const response = await fetch(IP_API);
                const data = await response.json();
                const ipAddress = data.ip;

                const playerName = prompt("Enter your name:");
                if (playerName) {
                    const playerData = { name: playerName, ip: ipAddress };
                    saveToEncryptedJSON(playerData);
                } else {
                    alert("Player name is required to register!");
                }
            } catch (error) {
                console.error("Failed to fetch IP:", error);
            }
        }

        // Save encrypted JSON data
        function saveToEncryptedJSON(data) {
            const encryptedData = CryptoJS.AES.encrypt(JSON.stringify(data), ENCRYPTION_KEY).toString();
            localStorage.setItem("playerData", encryptedData);
        }

        // Decrypt JSON data
        function loadFromEncryptedJSON() {
            const encryptedData = localStorage.getItem("playerData");
            if (!encryptedData) return null;

            const bytes = CryptoJS.AES.decrypt(encryptedData, ENCRYPTION_KEY);
            return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));
        }

        // Update cookies and display
        function updateCookies() {
            cookieCountEl.textContent = cookies;
        }

        // Upgrade logic
        function buyUpgrade(upgradeType) {
            const upgrade = upgrades.find(u => u.name === upgradeType);
            if (cookies >= upgrade.cost) {
                cookies -= upgrade.cost;
                if (upgradeType === "Click Power") {
                    cpc += upgrade.multiplier;
                } else if (upgradeType === "CPS") {
                    cps += upgrade.multiplier;
                }
                upgrade.cost = Math.floor(upgrade.cost * 1.2); // Increase cost
                updateCookies();
            } else {
                alert("Not enough cookies!");
            }
        }

        // Max Upgrade
        function maxUpgrade() {
            upgrades.forEach(upgrade => {
                while (cookies >= upgrade.cost) {
                    buyUpgrade(upgrade.name);
                }
            });
        }

        // Event Listeners
        cookieBtn.addEventListener("click", () => {
            cookies += cpc;
            updateCookies();
        });
        upgradeClickPowerBtn.addEventListener("click", () => buyUpgrade("Click Power"));
        upgradeCPSBtn.addEventListener("click", () => buyUpgrade("CPS"));
        maxUpgradeBtn.addEventListener("click", maxUpgrade);

        // Load user data on startup
        window.onload = () => {
            const playerData = loadFromEncryptedJSON();
            if (playerData) {
                console.log(`Welcome back, ${playerData.name}`);
            }
        };

        // Block developer tools
        document.addEventListener("keydown", event => {
            if (
                event.key === "F12" || 
                (event.ctrlKey && event.shiftKey && event.key === "I")
            ) {
                alert("Developer tools are disabled!");
                event.preventDefault();
            }
        });
    </script>
</body>
</html>